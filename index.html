<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Formulir dengan Delete</title>
  <style>
    body { font-family: sans-serif; padding: 2em; }
    input, button { margin: 0.5em 0; padding: 0.5em; }
    table { border-collapse: collapse; margin-top: 2em; }
    td, th { border: 1px solid #ccc; padding: 0.5em 1em; }
  </style>
</head>
<body>
  <h2>Formulir Pendaftaran</h2>
  <form id="formulir">
    <input type="text" name="nama" placeholder="Nama" required><br>
    <input type="email" name="email" placeholder="Email" required><br>
    <button type="submit">Tambah</button>
  </form>

  <p id="status"></p>
  <h3>Data Tersimpan:</h3>
  <table id="dataTable">
    <thead><tr><th>Nama</th><th>Email</th><th>Aksi</th></tr></thead>
    <tbody></tbody>
  </table>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbyKMkuiRFiHVOoQnk4OJpIRVCqbYwWxziMqXI-RfSjt13PsHkdzFnj-uXkfoC1rUFUvkw/exec'; // Ganti dengan punyamu
    const form = document.getElementById('formulir');
    const tableBody = document.querySelector('#dataTable tbody');
    const status = document.getElementById('status');

    // Tambah data
    form.addEventListener('submit', e => {
      e.preventDefault();
      const formData = new FormData(form);
      formData.append("action", "add");

      fetch(scriptURL, { method: 'POST', body: formData })
        .then(() => {
          status.textContent = "Data berhasil ditambahkan!";
          form.reset();
          loadData();
        })
        .catch(() => status.textContent = "Gagal menambah data.");
    });

    // Hapus data
    function deleteRow(rowNum) {
      const formData = new FormData();
      formData.append("action", "delete");
      formData.append("row", rowNum); // baris spreadsheet (1-based)

      fetch(scriptURL, { method: 'POST', body: formData })
        .then(() => {
          status.textContent = "Data berhasil dihapus!";
          loadData();
        })
        .catch(() => status.textContent = "Gagal menghapus data.");
    }

    // Tampilkan data
    function loadData() {
      fetch(scriptURL)
        .then(res => res.json())
        .then(data => {
          tableBody.innerHTML = "";
          data.slice(1).forEach((row, index) => {
            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td>${row[0]}</td>
              <td>${row[1]}</td>
              <td><button onclick="deleteRow(${index + 2})">Hapus</button></td>
            `;
            tableBody.appendChild(tr);
          });
        });
    }

    // Pertama kali load
    loadData();
  </script>
</body>
</html>

